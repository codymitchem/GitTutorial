This is the second version of my source code  